window.Wized=window.Wized||[],window.Wized.push(async e=>{let t=!1,a=!1,n=!1,r=(t,r=!1)=>{if(t.data&&"object"==typeof t.data){let i=t.data.items||[];if(i.length>0){if(r&&Array.isArray(e.data.v.coop_contracts)){let c=new Set(e.data.v.coop_contracts.map(e=>e.id)),d=i.filter(e=>!c.has(e.id));e.data.v.coop_contracts=[...e.data.v.coop_contracts,...d]}else e.data.v.coop_contracts=i;e.data.v.page_number_next=t.data.nextPage||null;let l=document.querySelector('[wized-filter="empty-state"]');l&&l.classList.add("is-hidden");let o=document.querySelector('[wized="contract_main_wrapper"]');o&&o.classList.remove("is-hidden")}else{r||(e.data.v.coop_contracts=[]),e.data.v.page_number_next=null;let s=document.querySelector('[wized-filter="empty-state"]');s&&s.classList.remove("is-hidden");let u=document.querySelector('[wized="contract_main_wrapper"]');u&&u.classList.add("is-hidden")}}else{r||(e.data.v.coop_contracts=[]),e.data.v.page_number_next=null;let p=document.querySelector('[wized-filter="empty-state"]');p&&p.classList.remove("is-hidden");let g=document.querySelector('[wized="contract_main_wrapper"]');g&&g.classList.add("is-hidden")}a=!1,n=!1};try{let i=await e.requests.execute("get_coop_contracts");r(i,!1),t=!0}catch(c){console.error("Error during initial request:",c),r({data:null},!1),t=!0}e.on("request",e=>{"get_coop_contracts"===e.name&&r(e,n)});let d=async()=>{if(!a&&t&&null!==e.data.v.page_number_next){a=!0,n=!0;try{e.data.v.page_number_current+=1;let i=await e.requests.execute("get_coop_contracts");i.data&&"object"==typeof i.data&&(i.data.items||[]).length>0?(r(i,!0),null!==i.data.nextPage?e.data.v.page_number_next=i.data.nextPage:e.data.v.page_number_next=null):e.data.v.page_number_next=null}catch(c){console.error("Error during pagination request:",c),e.data.v.page_number_next=null}finally{a=!1}}},l=document.querySelector('[wized="pagination-trigger"]');if(l){let o=new MutationObserver(()=>{l.getBoundingClientRect().bottom<=window.innerHeight&&d()});o.observe(l,{attributes:!0,childList:!0,subtree:!0}),window.addEventListener("scroll",()=>{l.getBoundingClientRect().bottom<=window.innerHeight&&d()});let s=()=>{null===e.data.v.page_number_next&&o.disconnect()};setInterval(s,1e3)}});
